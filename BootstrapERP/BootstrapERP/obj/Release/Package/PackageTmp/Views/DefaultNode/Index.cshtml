@model BootstrapERP.Models.AddNode
@using System.Data;
@{
    ViewBag.Title = "Default Node List";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container">
    <div class="row">
        <div class="col-lg-12">
            <div class="page-header">
                <h4 style="display:inline-block"><span class="hapText"> @ViewBag.Title </span><small> </small></h4>
                <ol class="breadcrumbLine" style="float:right;display:inline-block">
                    <li class="hapText">@Html.ActionLink("Home", "Index", "BlogPosts")</li>
                    <li class="hapText">@ViewBag.Title</li>
                </ol>
            </div>
        </div>
        <div class="clearfix"></div>
        <div class="col-sm-12" style="min-height:550px">
            @using (Html.BeginForm("Index", "DefaultNode"))
            {
                @Html.ValidationSummary(true)
                @Html.AntiForgeryToken()
                <div class="row">
                    <div class="col-lg-6 col-md-6">
                        <div style="margin-left:0px;">
                            <button id="addNode" class="btn btn-primary btn-anim"><i class="glyphicon glyphicon-plus"></i><span class="btn-text">Add Node</span></button>
                            <button id="editNode" class="btn btn-success btn-anim"><i class="fa fa-pencil-square-o"></i><span class="btn-text">Edit Node</span></button>
                            <div class="clearfix"></div>
                        </div>
                        <div class="clearfix"></div>
                        <br />
                        <input type="hidden" name="selectedItems" id="selectedItems" />
                        <div class="panel panel-primary">
                            <div class="panel-body" style="height:460px;overflow-y: auto;overflow-x:auto;white-space: nowrap;">
                                <div id="tree" class="checkboxes"></div>
                                <div class="clearfix"></div>
                                <br />
                            </div>
                        </div>
                    </div>

                </div>
                <div class="clearfix"></div>
            }
        </div>


    </div>
</div>



@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script src="~/Scripts/Gijgo/gijgo.js"></script>
    <script src="~/Scripts/conditional-validation.js"></script>
    <link href="~/http://code.gijgo.com/1.3.0/css/gijgo.css" rel="stylesheet" type="text/css" />


    <script src="/js/jquery.js" type="text/javascript"></script>
    @*<script src="/js/jquery.contextMenu.js" type="text/javascript"></script>*@
    

    <script type="text/javascript">

        $(document).ready(function () {
            var Usertree = "";
            var tree = "";
            $.ajax({
                type: 'get',
                dataType: 'json',
                cache: false,
                url: '@Url.Action("GetHierarchy", "DefaultNode")',
                success: function (records, textStatus, jqXHR) {
                    tree = $('#tree').tree({
                        primaryKey: 'Id',
                        dataSource: records,
                        checkboxes: true,
                        cascadeCheck: false,
                        //iconsLibrary: 'glyphicons',
                        icons: {
                            expand: '<img src="http://27.147.194.136:82/Images/Expand.png" class="material-icons" />',
                            collapse: '<img class="material-icons" src="http://27.147.194.136:82/Images/Collapse.png" />'

                            //expand: '<img src="/Images/Expand.png" class="material-icons" />',
                            //collapse: '<img class="material-icons" src="/Images/Collapse.png" />'
                        },
                    });

                    
                    
                    //Usertree = $('#Usertree').tree({
                    //    primaryKey: 'Id',
                    //    dataSource: records,
                    //    checkboxes: true,
                    //    cascadeCheck: false,
                    //    iconsLibrary: 'glyphicons',
                    //    selectionType: 'single',
                        
                    //});

                    $('input:checkbox').click(function () {
                        $('input:checkbox').not(this).prop('checked', false);
                    });

                    //Add new node
                    $('#addNode').click(function (e) {
                        e.preventDefault();
                        var id = tree.getCheckedNodes();
                        if (id != "") {
                            window.location.href = '@Url.Action("NewNode", "DefaultNode")/' + id;
                        }
                        else {
                            alert('Please select node.');
                        }
                        
                    });
                    //Edit node
                    $('#editNode').click(function (e) {
                        e.preventDefault();
                        var id = tree.getCheckedNodes();
                        if (id != "") {
                            window.location.href = '@Url.Action("SubsistNode", "DefaultNode")/' + id;
                        }
                        else {
                            alert('Please select node.');
                        }
                    });
                },

                error: function (jqXHR, textStatus, errorThrown) {
                    alert('Error - ' + errorThrown);
                }
            });
        });

        
    </script>
    <style>
        .checkboxes {
            float: none;
            display: block;
            line-height: 23px;
            /*font-family: Verdana,Geneva,sans-serif;*/
            font-family: Helvetica;
            color:black;
            font-weight: 300;
        }
        .checkboxes input {
                margin: 0px 0px 0px 0px;
                }
        .checkboxes label {
                margin: 7px 5px 0px 0px;
            }
            
    </style>

}